<div class="flex flex-col justify-center flex-1 w-full max-w-md mx-auto">
    <div>
      <div class="mb-5 sm:mb-8">
        <h1 class="mb-2 font-semibold text-gray-800 text-title-sm dark:text-white/90 sm:text-title-md">
          Connexion
        </h1>
        <p class="text-sm text-gray-500 dark:text-gray-400">
          Entrez vos identifiants pour accéder à Medicore
        </p>
      </div>

      <!-- Message d'erreur -->
      <div *ngIf="errorMessage" class="mb-6 p-4 bg-red-50 border border-red-200 text-red-700 rounded-lg">
        {{ errorMessage }}
      </div>

      <!-- Loader pendant la connexion -->
      <div *ngIf="isLoading" class="flex justify-center my-6">
        <svg class="animate-spin h-8 w-8 text-brand-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
      </div>

      <!-- Formulaire -->
      <form (ngSubmit)="onSignIn()" class="space-y-6" [class.opacity-50]="isLoading">

        <div>
          <label>Email <span class="text-error-500">*</span></label>
          <app-input-field
            type="email"
            placeholder="votre.email@medecin.fr"
            [value]="username"                    
            (valueChange)="username = $any($event)"     
            name="email"
            class="form-input"
            required
          />
        </div>

        <div>
          <label>Mot de passe <span class="text-error-500">*</span></label>
          <div class="relative">
          <app-input-field
              [type]="showPassword ? 'text' : 'password'"
              placeholder="••••••••"
              [value]="password"                 
              (valueChange)="password = $any($event)"
              name="password"
              class="form-input"
              required
            />
            <span
              (click)="togglePasswordVisibility()"
              class="absolute z-30 -translate-y-1/2 cursor-pointer right-4 top-1/2 text-gray-500 dark:text-gray-400"
            >
              @if (showPassword) {
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 13.8619C7.23361 13.8619 4.86803 12.1372 3.92328 9.70241C4.86804 7.26761 7.23361 5.54297 10 5.54297C12.7667 5.54297 15.1323 7.26762 16.0771 9.70243C15.1323 12.1372 12.7667 13.8619 10 13.8619ZM10 4.04297C6.48191 4.04297 3.49489 6.30917 2.4155 9.4593C3.49488 13.0957 6.48191 15.3619 10 15.3619C13.5184 15.3619 16.5055 13.0957 17.5849 9.94555C16.5055 6.30919 13.5184 4.04297 10 4.04297Z" fill="currentColor"/>
                </svg>
              } @else {
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.63803 3.57709C4.34513 3.2842 3.87026 3.2842 3.57737 3.57709C3.28447 3.86999 3.28447 4.34486 3.57737 4.63775L15.3625 16.4229C15.6554 16.7158 16.1302 16.7158 16.4231 16.4229C16.716 16.13 16.716 15.6551 16.4231 15.3622L4.63803 3.57709Z" fill="currentColor"/>
                </svg>
              }
            </span>
          </div>
        </div>

        <div class="flex items-center justify-between">
          <a routerLink="/forgot-password" class="text-sm text-brand-500 hover:text-brand-600 dark:text-brand-400 hover:underline">
            Mot de passe oublié ?
          </a>

        </div>

        <button
          type="submit"
          class="w-full bg-brand-500 text-white py-3 rounded-lg hover:bg-brand-600 disabled:opacity-50"
          [disabled]="isLoading"
        >
          {{ isLoading ? 'Connexion en cours...' : 'Se connecter' }}
        </button>
      </form>
    </div>

    <p class="text-center text-sm text-gray-500 dark:text-gray-400 mt-8">
      Medicore – Votre cabinet connecté, sécurisé et conforme HDS
    </p>
  </div>